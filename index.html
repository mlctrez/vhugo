<!DOCTYPE html>
<html lang="en" data-ng-app="pcApp">
<head>
  <meta charset="utf-8">
  <title>vhugo</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css"
        integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"
          integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"
          integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.1/angular.min.js"
          integrity="sha256-3SrLjPeRPa1ofM280r+OMcUjJZKLWJHr6SRtRu3dRb0=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.1/angular-route.min.js"
          integrity="sha256-SUsNyx9Kr9rHA3thrzSefdS883z1Q0ZOLXPF3p2Tt+o=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.1/angular-resource.min.js"
          integrity="sha256-UzSbSKd9UMo8E8MPnTx9OTfXYin6xmVHCnmOOUDYn68=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-websocket/2.0.1/angular-websocket.min.js"
          integrity="sha256-hUPHk8oFbwSZXFo3d3boJAR7eBTEtXLGTx8PidqDT7Q=" crossorigin="anonymous"></script>

</head>

<body>

<div data-ng-view="" class="container"></div>

<script type="text/ng-template" id="home.tpl">

  <h4>Item</h4>
  <div class="row">
    <div class="col-md-12">
      <form class="form-horizontal">
        <div class="form-group">
          <label for="bucket">Bucket</label>
          <input type="text" class="form-control" id="bucket" data-ng-model="bucket">
        </div>
        <div class="form-group">
          <label for="key">Key</label>
          <input type="text" class="form-control" id="key" data-ng-model="key">
        </div>
        <div class="form-group">
          <label for="content">Content</label>
          <textarea class="form-control" id="content" data-ng-model="content"></textarea>
        </div>
        <button class="btn btn-default" data-ng-click="updateItem()">Save</button>
      </form>
    </div>
  </div>


  <div class="row">
    <div class="col-md-12">
      <div ng-repeat="(key, value) in buckets">
        {{key}} == {{value}}<br>
      </div>
    </div>
  </div>

</script>


<script language="javascript">
  'use strict';

  var pcApp = angular.module('pcApp', ['ngRoute', 'ngResource']);

  pcApp.factory('Entry', function ($resource) {
    return $resource('/buckets/:bucket/:key', {bucket: '@bucket', key: '@key'});
  });

  pcApp.controller('HomeController', ['$scope', 'Entry', function ($scope, Entry) {
    $scope.bucket = "";
    $scope.key = "";
    $scope.content = "";

    $scope.updateItem = function () {
      Entry.save({bucket: $scope.bucket, key: $scope.key, content: JSON.parse($scope.content)});
    };


  }]);


  // routes
  pcApp.config(['$routeProvider', function ($routeProvider) {
    $routeProvider.when('/home', {
      templateUrl: 'home.tpl', controller: 'HomeController'
    }).otherwise({
      redirectTo: '/home'
    });
  }]);

</script>
</body>
</html>
